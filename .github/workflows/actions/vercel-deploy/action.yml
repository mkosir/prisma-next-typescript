name: 'vercel-deploy'
description: 'Vercel deploy'

inputs:
  environment:
    description: 'Environment'
    required: false
    default: 'preview'
  vercel-token:
    description: 'Vercel token'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Install Vercel CLI üîß
      shell: bash
      run: npm install --global vercel@latest

    - name: Pull Vercel Environment Information ‚¨áÔ∏è
      shell: bash
      run: vercel pull --yes --environment=${{ inputs.environment }} --token=${{ inputs.vercel-token }}

    - name: Build Project Artifacts üèóÔ∏è
      shell: bash
      run: |
        prodRun=""
        if [[ ${{ inputs.environment }} == "production" ]]; then
          prodRun="--prod"
        fi
        vercel build --token=${{ inputs.vercel-token }} $prodRun

    - name: Deploy Project Artifacts to Vercel üöÄ
      shell: bash
      run: |
        prodRun=""
         if [[ ${{ inputs.environment }} == "production" ]]; then
           prodRun="--prod"
         fi
         vercel deploy --prebuilt --token=${{ inputs.vercel-token }} $prodRun
